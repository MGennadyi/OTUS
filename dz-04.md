# Установка и настройка PostgreSQL в контейнере Docker
1. Сделать в GCE инстанс с Ubuntu 20.04

Navigation menu/compute engine/vm instances/create instance/.../create

2. Поставить на нем Docker Engine
```
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
rm get-docker.sh
sudo usermod -aG docker $USER
```
 
3. Сделать каталог /var/lib/postgres
```
sudo mkdir /var/lib/postgres
```

4. Развернуть контейнер с PostgreSQL 13 смонтировав в него /var/lib/postgres
4.1 Создаем docker-сеть pg-net: 
```
sudo docker network create pg-net
```
4.2 Подключение сети к контейнеру сервера Postgres, первый запуск через скачивание образа из docker HUB:
```
sudo docker run --name pg-docker --network pg-net -e POSTGRES_PASSWORD=12345 -d -p 5432:5432 -v /var/lib/postgres:/var/lib/postgresql/data postgres:13
```

5. Запускаем отдельный контейнер с клиентом в общей сети с БД:
```
sudo docker run -it --rm --network pg-net --name pg-client postgres:13 psql -h pg-docker -U postgres
```
6. Проверяем, что имеем:
```
sudo docker container ls
```
Ответ:

CONTAINER ID   IMAGE         COMMAND                  CREATED        STATUS        PORTS                                       NAMES

790f906e3ffd   postgres:13   "docker-entrypoint.s…"   24 hours ago   Up 24 hours   0.0.0.0:5432->5432/tcp, :::5432->5432/tcp   pg-docker



6. Подключится из контейнера с клиентом к контейнеру с сервером и сделать
таблицу с парой строк

7. Подключится к контейнеру с сервером с ноутбука/компьютера извне инстансов GCP

8. Удалить контейнер с сервером

9. Создать его заново

10. Подключится снова из контейнера с клиентом к контейнеру с сервером

11. Проверить, что данные остались на месте

